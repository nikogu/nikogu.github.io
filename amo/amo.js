/*!
 * amo.js
 * easy to use css animation
 * http://nikogu.github.com/amo
 *
 * @author niko
 * @date 2014-12-31
 */
!function(t){function n(t,n){return t.indexOf(n)}function e(t){return"[object Array]"===Object.prototype.toString.call(t)||void 0!==t.length}function a(t){return"[object Number]"===Object.prototype.toString.call(t)}function i(t,n){e(t)?Array.prototype.forEach.call(t,function(t){n(t)}):n(t)}function r(t,e){var a=t.className.split(" ");-1==n(a,e)&&(a.push(e),t.className=a.join(" "))}function o(t,e){var a=t.className.split(" "),i=n(a,e);i>=0&&(a.splice(i,1),t.className=a.join(" "))}function s(){return"Amo-frame-"+Math.floor(1e7*Math.random())}function c(){return"Amo-transition-"+Math.floor(1e7*Math.random())}function u(t,n,e){var i=g.map(function(t){return t+"keyframes"}),r="",o="{";if(e){o+="0% {";for(var s in n)o+=s+":",o+=n[s]+";";o+="}",o+="100% {";for(var s in e)o+=s+":",o+=e[s]+";";o+="}"}else for(var s in n)if(a(1*s)&&n.hasOwnProperty(s)){o+=s+"% {";for(var c in n[s])o+=c+":",o+=n[s][c]+";";o+="}"}o+="}";for(var u=0;u<i.length;u++)r+="@"+i[u]+" "+t,r+=o;return r}function m(t,n,e,a,i,r,o){var s=g.map(function(t){return t+"animation"}),u="",m=c();u+="."+m+"{";for(var f=s.length;f--;)u+=s[f]+"-name:"+t+";",u+=s[f]+"-duration:"+n/1e3+"s;",u+=s[f]+"-timing-function:"+e+";",u+=s[f]+"-iteration-count:"+a+";",u+=s[f]+"-fill-mode:"+o+";",u+=s[f]+"-delay:"+i+";",u+=s[f]+"-direction:"+r+";";return u+="}",w(u),m}function f(t,n){var e=s();return y[e]={frameName:e,style:u(e,t,n),animate:l},w(y[e].style),y[e]}function l(t){var t=t||{},n=t.time||1;0>n&&(n="infinite");var e=t.duration||1e3,a=t.easing||"ease",i=t.delay||0,r=t.direction||"normal",o=t.mode||"forwards",s=m(this.frameName,e,a,n,i,r,o);return{className:s,time:n,duration:e,run:d}}function d(t,n){var e=this.className,a=this.duration,s=this.time;i(t,function(t){o(t,e)}),setTimeout(function(){i(t,function(t){r(t,e)})},0);var c={className:e,node:t,time:s,duration:a,callback:n,stop:p,start:v,reset:h};return c.start(),c}function p(){var t=this;a(t.time)&&t.callback&&(t.state="stop",t.stopTime=(new Date).getTime()),i(t.node,function(t){r(t,"amo-animation-pause")})}function v(){var t=this;a(t.time)&&t.callback?("stop"==t.state&&i(t.node,function(t){o(t,"amo-animation-pause")}),"running"==t.state||t.isOver||(t.state="running",t.startTime=(new Date).getTime(),i(t.node,function(n){n.addEventListener("webkitAnimationEnd",function(){t.isOver||t.callback(),t.isOver=!0}),n.addEventListener("animationEnd",function(){t.isOver||t.callback(),t.isOver=!0})}))):i(t.node,function(t){o(t,"amo-animation-pause")})}function h(){var t=this;t.isOver=!1,t.state="",i(t.node,function(n){o(n,t.className)}),setTimeout(function(){i(t.node,function(n){r(n,t.className)})},16.66),t.start()}var y={},g=["","-webkit-"];!function(){Array.prototype.map||(Array.prototype.map=function(t,n){var e,a,i;if(null==this)throw new TypeError(" this is null or not defined");var r=Object(this),o=r.length>>>0;if("[object Function]"!={}.toString.call(t))throw new TypeError(t+" is not a function");for(n&&(e=n),a=new Array(o),i=0;o>i;){var s,c;i in r&&(s=r[i],c=t.call(e,s,i,r),a[i]=c),i++}return a})}();var w=function(){var t,n=/\W/g,e=document,a=document.getElementsByTagName("head")[0]||document.documentElement,i=function(i,r){if(!r||(r=r.replace(n,"-"),!e.getElementById(r))){var o;if(!t||r?(o=e.createElement("style"),r&&(o.id=r),a.appendChild(o)):o=t,void 0!==o.styleSheet){if(e.getElementsByTagName("style").length>31)throw new Error("Exceed the maximal count of style tags in IE");o.styleSheet.cssText+=i}else o.appendChild(e.createTextNode(i));r||(t=o)}};return i}();!function(){for(var t=".amo-animation-pause { ",n=g.length;n--;)t+=g[n]+"animation-play-state: paused !important;";t+="}",w(t)}();var E={keyframes:f};t.Amo=E}(window);